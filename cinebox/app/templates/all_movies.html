{% extends 'base.html' %}
{% block title %}T·∫•t c·∫£ phim ¬∑ CineBox{% endblock %}
{% block content %}
<style>
.filter-section {
  background: #0b1020 !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
  border-radius: 8px !important;
  padding: 12px !important;
  margin-bottom: 12px !important;
}

.filter-group label {
  font-size: 0.8rem !important;
}

.filter-select {
  padding: 8px 12px !important;
  font-size: 0.85rem !important;
}

.btn-filter {
  padding: 8px 16px !important;
  font-size: 0.85rem !important;
}

.filter-row {
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
  align-items: center;
}

.filter-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-width: 150px;
}

.filter-group label {
  color: #e7e9ee;
  font-size: 0.85rem;
  font-weight: 500;
}

.filter-select {
  background: #141a28;
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  padding: 10px 12px;
  color: #e7e9ee;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-select:hover {
  border-color: #3b82f6;
  background: rgba(59, 130, 246, 0.1);
}

.filter-select:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.filter-select option {
  background: #141a28;
  color: #e7e9ee;
}

.filter-actions {
  display: flex;
  gap: 10px;
  margin-left: auto;
}

.btn-filter {
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  font-size: 0.9rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-filter-reset {
  background: #141a28;
  color: #e7e9ee;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.btn-filter-reset:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.2);
}

.results-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  scroll-margin-top: 64px; /* Offset for fixed header */
}

.results-count {
  font-size: 0.8rem;
}

.results-header h1 {
  color: #fff;
  margin: 0;
  font-size: 1.5rem;
}

.movies-grid {
  display: grid;
  grid-template-columns: repeat(6, minmax(0, 1fr));
  gap: 20px;
  margin: 20px 0 30px;
}

.card {
  position: relative;
  background: #141a28;
  border-radius: 6px;
  overflow: hidden;
  border: 1px solid rgba(255, 255, 255, 0.08);
  backdrop-filter: blur(10px);
  display: flex;
  flex-direction: column;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  min-height: 100%;
  max-width: 200px;
  margin: 0 auto;
}

.card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  border-color: rgba(59, 130, 246, 0.6);
}

.card-link {
  display: flex;
  flex-direction: column;
  height: 100%;
  color: inherit;
  text-decoration: none;
}

.poster {
  width: 100%;
  height: 270px;
  background-size: cover;
  background-position: center;
  flex-shrink: 0;
}

.card-content {
  padding: 10px;
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
}

.card-title {
  color: #fff;
  font-weight: 600;
  margin-bottom: 4px;
  font-size: 0.95rem;
  line-height: 1.25;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.card-meta {
  display: flex;
  gap: 6px;
  font-size: 0.75rem;
  color: #a8b2c3;
  margin-bottom: 4px;
}

.card-meta .year {
  background: rgba(255, 255, 255, 0.08);
  padding: 2px 6px;
  border-radius: 999px;
  color: #fff;
}

.card-meta .country {
  color: #a8b2c3;
}

.card-genres {
  font-size: 0.75rem;
  color: #c9d4f1;
  opacity: 0.85;
  margin-bottom: 6px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.movie-rating {
  display: flex;
  align-items: center;
  gap: 6px;
  margin-top: auto;
  font-size: 0.75rem;
}

.rating-stars {
  color: #ffc107;
  font-weight: 700;
  font-size: 0.8rem;
}

.rating-count {
  color: #8f98b2;
  font-size: 0.7rem;
}

.view-count {
  color: #8f98b2;
  font-size: 0.7rem;
  display: flex;
  align-items: center;
  gap: 4px;
}

@media (max-width: 1100px) {
  .movies-grid {
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }
}

@media (max-width: 768px) {
  .movies-grid {
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 14px;
  }
}

@media (max-width: 520px) {
  .movies-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
  
  .poster {
    height: 200px;
  }
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 12px;
  margin: 20px 0;
}

.empty-icon {
  font-size: 3rem;
  margin-bottom: 15px;
}

.empty-state h4 {
  color: #fff;
  margin: 0 0 10px 0;
  font-size: 1.2rem;
}

.empty-state p {
  color: #888;
  margin: 0;
  line-height: 1.5;
}

@media (max-width: 768px) {
  .filter-row {
    flex-direction: column;
    align-items: stretch;
  }
  
  .filter-group {
    min-width: 100%;
  }
  
  .filter-actions {
    margin-left: 0;
    width: 100%;
  }
  
  .btn-filter {
    flex: 1;
  }
  
  .movies-grid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 15px;
  }
}
</style>

<div class="container">
  <div class="main-content">
    <div class="results-header">
      <h1>üé¨ T·∫•t c·∫£ phim</h1>
    </div>

    <!-- Filter Section -->
    <div class="filter-section">
      <form method="GET" action="{{ url_for('main.all_movies') }}" id="filterForm">
        <div class="filter-row">
          <div class="filter-group">
            <label for="sort">S·∫Øp x·∫øp theo</label>
            <select name="sort" id="sort" class="filter-select">
              <option value="newest" {% if sort_by == 'newest' %}selected{% endif %}>M·ªõi nh·∫•t</option>
              <option value="oldest" {% if sort_by == 'oldest' %}selected{% endif %}>C≈© nh·∫•t</option>
              <option value="views" {% if sort_by == 'views' %}selected{% endif %}>L∆∞·ª£t xem nhi·ªÅu nh·∫•t</option>
              <option value="ratings" {% if sort_by == 'ratings' %}selected{% endif %}>ƒê√°nh gi√° cao nh·∫•t</option>
              <option value="title_asc" {% if sort_by == 'title_asc' %}selected{% endif %}>T√™n A-Z</option>
              <option value="title_desc" {% if sort_by == 'title_desc' %}selected{% endif %}>T√™n Z-A</option>
            </select>
          </div>
          
          <div class="filter-group">
            <label for="year">NƒÉm ph√°t h√†nh</label>
            <select name="year" id="year" class="filter-select">
              <option value="">T·∫•t c·∫£ nƒÉm</option>
              {% for year in year_list %}
              <option value="{{ year }}" {% if year_filter|string == year|string %}selected{% endif %}>{{ year }}</option>
              {% endfor %}
            </select>
          </div>
          
          <div class="filter-group">
            <label for="genre">Th·ªÉ lo·∫°i</label>
            <select name="genre" id="genre" class="filter-select">
              <option value="">T·∫•t c·∫£ th·ªÉ lo·∫°i</option>
              {% for genre in genre_list %}
              <option value="{{ genre }}" {% if genre_filter == genre %}selected{% endif %}>{{ genre }}</option>
              {% endfor %}
            </select>
          </div>
          
          <div class="filter-actions">
            <button type="button" class="btn-filter btn-filter-reset" onclick="resetFilters()">
              üîÑ ƒê·∫∑t l·∫°i
            </button>
          </div>
        </div>
      </form>
    </div>

    <!-- Movies Grid -->
    {% if movies %}
    <div class="movies-grid" id="moviesGrid">
      {% for movie in movies %}
      <div class="card">
        <a href="{{ url_for('main.detail', movie_id=movie.id) }}" class="card-link">
          <div class="poster" style="background-image:url('{{ movie.poster }}')"></div>
          <div class="card-content">
            <div class="card-title">{{ movie.title }}</div>
            <div class="card-meta">
              {% if movie.year %}<span class="year">{{ movie.year }}</span>{% endif %}
              {% if movie.country %}<span class="country">{{ movie.country }}</span>{% endif %}
            </div>
            {% if movie.genres %}<div class="card-genres">{{ movie.genres|join(', ') }}</div>{% endif %}
            <div class="movie-rating" data-movie-id="{{ movie.id }}">
              <span class="rating-stars">
                {% if movie.avgRating and movie.avgRating > 0 %}
                  ‚≠ê {{ "%.1f"|format(movie.avgRating) }}
                {% else %}
                  ‚≠ê 0.0
                {% endif %}
              </span>
              <span class="rating-count">
                {% if movie.ratingCount and movie.ratingCount > 0 %}
                  ({{ movie.ratingCount }})
                {% else %}
                  (0)
                {% endif %}
              </span>
              {% if movie.viewCount and movie.viewCount > 0 %}
              <span class="view-count" style="margin-left: 8px; color: #888; font-size: 0.9em;">
                üëÅÔ∏è {{ movie.viewCount }}
              </span>
              {% endif %}
            </div>
          </div>
        </a>
        <div class="action-buttons">
          <button class="watchlist-btn" onclick="toggleWatchlist({{ movie.id }}, event)" data-movie-id="{{ movie.id }}">
            <span class="watchlist-icon">üìã</span>
          </button>
          <button class="favorite-btn" onclick="toggleFavorite({{ movie.id }}, event)" data-movie-id="{{ movie.id }}">
            <span class="favorite-icon">ü§ç</span>
          </button>
        </div>
      </div>
      {% endfor %}
    </div>
    
    <!-- Pagination -->
    {% if pagination and pagination.pages > 1 %}
    <div class="pagination" id="paginationContainer">
      <div class="pagination-controls" id="paginationControls">
        <!-- Pagination buttons will be generated by JavaScript -->
      </div>
    </div>
    {% endif %}
    {% else %}
    <div class="empty-state">
      <div class="empty-icon">üé¨</div>
      <h4>Kh√¥ng t√¨m th·∫•y phim n√†o</h4>
      <p>H√£y th·ª≠ thay ƒë·ªïi b·ªô l·ªçc ƒë·ªÉ t√¨m phim kh√°c.</p>
    </div>
    {% endif %}
  </div>
</div>

<script>
// Pagination state
let currentPage = {{ pagination.page if pagination else 1 }};
let totalPages = {{ pagination.pages if pagination else 1 }};
let currentSort = '{{ sort_by }}';
let currentYear = '{{ year_filter }}';
let currentGenre = '{{ genre_filter }}';
let isLoading = false;

// Generate pagination numbers with smart logic
function generatePaginationNumbers(current, total) {
  const numbers = [];
  const showAdjacent = 2; // Show 2 pages adjacent to current
  
  // Always show first page
  if (total > 0) {
    numbers.push(1);
  }
  
  // Calculate start and end of visible range
  let start = Math.max(2, current - showAdjacent);
  let end = Math.min(total - 1, current + showAdjacent);
  
  // Adjust if we're near the beginning
  if (current <= showAdjacent + 2) {
    end = Math.min(total - 1, showAdjacent * 2 + 2);
  }
  
  // Adjust if we're near the end
  if (current >= total - showAdjacent - 1) {
    start = Math.max(2, total - showAdjacent * 2 - 1);
  }
  
  // Add ellipsis after first page if needed
  if (start > 2) {
    numbers.push('ellipsis-start');
  }
  
  // Add page numbers in range
  for (let i = start; i <= end; i++) {
    if (i !== 1 && i !== total) {
      numbers.push(i);
    }
  }
  
  // Add ellipsis before last page if needed
  if (end < total - 1) {
    numbers.push('ellipsis-end');
  }
  
  // Always show last page (if more than 1 page)
  if (total > 1) {
    numbers.push(total);
  }
  
  return numbers;
}

// Render pagination component
function renderPagination(page, total) {
  const container = document.getElementById('paginationControls');
  if (!container) return;
  
  container.innerHTML = '';
  
  // Previous button
  const prevBtn = document.createElement('button');
  prevBtn.type = 'button';
  prevBtn.className = 'btn-pagination btn-pagination-icon' + (page <= 1 ? ' disabled' : '');
  prevBtn.innerHTML = '‚Üê';
  prevBtn.disabled = page <= 1;
  prevBtn.onclick = (e) => {
    e.preventDefault();
    e.stopPropagation();
    if (!isLoading && page > 1) loadPage(page - 1);
  };
  container.appendChild(prevBtn);
  
  // Page numbers
  const pageNumbers = generatePaginationNumbers(page, total);
  pageNumbers.forEach(num => {
    if (num === 'ellipsis-start' || num === 'ellipsis-end') {
      const ellipsis = document.createElement('span');
      ellipsis.className = 'pagination-ellipsis';
      ellipsis.textContent = '...';
      container.appendChild(ellipsis);
    } else {
      const pageBtn = document.createElement('button');
      pageBtn.type = 'button';
      pageBtn.className = 'btn-pagination' + (num === page ? ' active' : '');
      pageBtn.textContent = num;
      pageBtn.onclick = (e) => {
        e.preventDefault();
        e.stopPropagation();
        if (!isLoading && num !== page) loadPage(num);
      };
      container.appendChild(pageBtn);
    }
  });
  
  // Next button
  const nextBtn = document.createElement('button');
  nextBtn.type = 'button';
  nextBtn.className = 'btn-pagination btn-pagination-icon' + (page >= total ? ' disabled' : '');
  nextBtn.innerHTML = '‚Üí';
  nextBtn.disabled = page >= total;
  nextBtn.onclick = (e) => {
    e.preventDefault();
    e.stopPropagation();
    if (!isLoading && page < total) loadPage(page + 1);
  };
  container.appendChild(nextBtn);
  
}

// Load movies via AJAX
function loadPage(page) {
  if (isLoading) return;
  
  isLoading = true;
  currentPage = page;
  
  // Get movies grid position to maintain scroll
  const grid = document.getElementById('moviesGrid');
  const gridPosition = grid ? grid.getBoundingClientRect().top + window.pageYOffset : 0;
  
  // Show loading state
  if (grid) {
    grid.style.opacity = '0.5';
    grid.style.pointerEvents = 'none';
  }
  
  // Build query params
  const params = new URLSearchParams({
    page: page,
    sort: currentSort,
  });
  if (currentYear) params.append('year', currentYear);
  if (currentGenre) params.append('genre', currentGenre);
  
  // Fetch movies
  fetch(`/api/all-movies?${params.toString()}`)
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        // Update movies grid
        if (grid && data.movies) {
          grid.innerHTML = data.movies.map(movie => `
            <div class="card">
              <a href="/movie/${movie.id}" class="card-link">
                <div class="poster" style="background-image:url('${movie.poster}')"></div>
                <div class="card-content">
                  <div class="card-title">${escapeHtml(movie.title)}</div>
                  <div class="card-meta">
                    ${movie.year ? `<span class="year">${movie.year}</span>` : ''}
                    ${movie.country ? `<span class="country">${escapeHtml(movie.country)}</span>` : ''}
                  </div>
                  ${movie.genres && movie.genres.length > 0 ? `<div class="card-genres">${escapeHtml(movie.genres.join(', '))}</div>` : ''}
                  <div class="movie-rating" data-movie-id="${movie.id}">
                    <span class="rating-stars">
                      ‚≠ê ${movie.avgRating ? movie.avgRating.toFixed(1) : '0.0'}
                    </span>
                    <span class="rating-count">
                      (${movie.ratingCount || 0})
                    </span>
                    ${movie.viewCount && movie.viewCount > 0 ? `
                    <span class="view-count" style="margin-left: 3px; color: #888; font-size: 0.44rem;">
                      üëÅÔ∏è ${movie.viewCount}
                    </span>
                    ` : ''}
                  </div>
                </div>
              </a>
              <div class="action-buttons">
                <button class="watchlist-btn" onclick="toggleWatchlist(${movie.id}, event)" data-movie-id="${movie.id}">
                  <span class="watchlist-icon">üìã</span>
                </button>
                <button class="favorite-btn" onclick="toggleFavorite(${movie.id}, event)" data-movie-id="${movie.id}">
                  <span class="favorite-icon">ü§ç</span>
                </button>
              </div>
            </div>
          `).join('');
        }
        
        // Update pagination
        if (data.pagination) {
          totalPages = data.pagination.pages;
          renderPagination(page, totalPages);
          
          // Update URL without reload
          const newUrl = `/all-movies?${params.toString()}`;
          window.history.pushState({ page: page }, '', newUrl);
        }
        
        // Scroll to "T·∫•t c·∫£ phim" section
        const resultsHeader = document.querySelector('.results-header');
        if (resultsHeader) {
          setTimeout(() => {
            const headerPosition = resultsHeader.getBoundingClientRect().top + window.pageYOffset;
            window.scrollTo({
              top: headerPosition - 140, // Offset for fixed navbar + gap
              behavior: 'smooth'
            });
          }, 100);
        }
        
        // Re-check favorite/watchlist status
        setTimeout(() => {
          checkAllFavoriteStatus();
          checkAllWatchlistStatus();
        }, 100);
      } else {
        alert('C√≥ l·ªói x·∫£y ra khi t·∫£i phim: ' + (data.message || 'Unknown error'));
      }
    })
    .catch(error => {
      console.error('Error loading movies:', error);
      alert('C√≥ l·ªói x·∫£y ra khi t·∫£i phim. Vui l√≤ng th·ª≠ l·∫°i.');
    })
    .finally(() => {
      isLoading = false;
      if (grid) {
        grid.style.opacity = '1';
        grid.style.pointerEvents = 'auto';
      }
    });
}

// Escape HTML to prevent XSS
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// Initialize pagination on page load
document.addEventListener('DOMContentLoaded', function() {
  {% if pagination and pagination.pages > 1 %}
  renderPagination({{ pagination.page }}, {{ pagination.pages }});
  {% endif %}
  
  // Handle browser back/forward buttons
  window.addEventListener('popstate', function(event) {
    const urlParams = new URLSearchParams(window.location.search);
    const page = parseInt(urlParams.get('page') || '1');
    if (page !== currentPage) {
      loadPage(page);
    }
  });
  
  // Update filters when form changes (prevent form submission)
  const filterForm = document.getElementById('filterForm');
  if (filterForm) {
    // Prevent form submission
    filterForm.addEventListener('submit', function(e) {
      e.preventDefault();
      currentSort = document.getElementById('sort')?.value || 'newest';
      currentYear = document.getElementById('year')?.value || '';
      currentGenre = document.getElementById('genre')?.value || '';
      loadPage(1); // Reset to page 1 when filters change
    });
    
    // Handle individual select changes
    const selects = filterForm.querySelectorAll('select');
    selects.forEach(select => {
      select.addEventListener('change', function() {
        currentSort = document.getElementById('sort')?.value || 'newest';
        currentYear = document.getElementById('year')?.value || '';
        currentGenre = document.getElementById('genre')?.value || '';
        loadPage(1); // Reset to page 1 when filters change
      });
    });
  }
});

function resetFilters() {
  currentSort = 'newest';
  currentYear = '';
  currentGenre = '';
  window.location.href = "{{ url_for('main.all_movies') }}";
}

// Check favorite and watchlist status for all movies on page load
document.addEventListener('DOMContentLoaded', function() {
  checkAllFavoriteStatus();
  checkAllWatchlistStatus();
});

// Favorite functionality
function toggleFavorite(movieId, event) {
  if (event) {
    event.preventDefault();
    event.stopPropagation();
  }
  
  fetch(`/toggle-favorite/${movieId}`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      updateFavoriteButton(movieId, data.is_favorite);
      showToast(data.message, 'success');
    } else {
      showToast(data.message, 'error');
    }
  })
  .catch(error => {
    console.error('Error:', error);
    showToast('C√≥ l·ªói x·∫£y ra khi chuy·ªÉn ƒë·ªïi tr·∫°ng th√°i y√™u th√≠ch', 'error');
  });
}

// Watchlist functionality
function toggleWatchlist(movieId, event) {
  if (event) {
    event.preventDefault();
    event.stopPropagation();
  }
  
  fetch(`/toggle-watchlist/${movieId}`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      updateWatchlistButton(movieId, data.is_watchlist);
      showToast(data.message, 'success');
    } else {
      showToast(data.message, 'error');
    }
  })
  .catch(error => {
    console.error('Error:', error);
    showToast('C√≥ l·ªói x·∫£y ra khi chuy·ªÉn ƒë·ªïi tr·∫°ng th√°i xem sau', 'error');
  });
}

function updateFavoriteButton(movieId, isFavorite) {
  const favoriteBtn = document.querySelector(`.favorite-btn[data-movie-id="${movieId}"]`);
  if (!favoriteBtn) return;
  
  const favoriteIcon = favoriteBtn.querySelector('.favorite-icon');
  if (!favoriteIcon) return;
  
  if (isFavorite) {
    favoriteIcon.textContent = '‚ù§Ô∏è';
    favoriteBtn.classList.add('favorited');
  } else {
    favoriteIcon.textContent = 'ü§ç';
    favoriteBtn.classList.remove('favorited');
  }
}

function updateWatchlistButton(movieId, isWatchlist) {
  const watchlistBtn = document.querySelector(`.watchlist-btn[data-movie-id="${movieId}"]`);
  if (!watchlistBtn) return;
  
  const watchlistIcon = watchlistBtn.querySelector('.watchlist-icon');
  if (!watchlistIcon) return;
  
  if (isWatchlist) {
    watchlistIcon.textContent = '‚úÖ';
    watchlistBtn.classList.add('watchlisted');
  } else {
    watchlistIcon.textContent = 'üìã';
    watchlistBtn.classList.remove('watchlisted');
  }
}

function checkFavoriteStatus(movieId) {
  fetch(`/check-favorite/${movieId}`, {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json',
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      updateFavoriteButton(movieId, data.is_favorite);
    }
  })
  .catch(error => {
    console.error('Error checking favorite status:', error);
  });
}

function checkWatchlistStatus(movieId) {
  fetch(`/check-watchlist/${movieId}`, {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json',
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      updateWatchlistButton(movieId, data.is_watchlist);
    }
  })
  .catch(error => {
    console.error('Error checking watchlist status:', error);
  });
}

function checkAllFavoriteStatus() {
  const favoriteBtns = document.querySelectorAll('.favorite-btn');
  favoriteBtns.forEach(btn => {
    const movieId = btn.getAttribute('data-movie-id');
    if (movieId) {
      checkFavoriteStatus(parseInt(movieId));
    }
  });
}

function checkAllWatchlistStatus() {
  const watchlistBtns = document.querySelectorAll('.watchlist-btn');
  watchlistBtns.forEach(btn => {
    const movieId = btn.getAttribute('data-movie-id');
    if (movieId) {
      checkWatchlistStatus(parseInt(movieId));
    }
  });
}

function showToast(message, type = 'success') {
  let toast = document.getElementById('toast');
  if (!toast) {
    toast = document.createElement('div');
    toast.id = 'toast';
    toast.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      background: #2d3748;
      color: white;
      padding: 16px 24px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      transform: translateX(400px);
      transition: transform 0.3s ease-in-out;
      max-width: 300px;
      border-left: 4px solid #48bb78;
    `;
    document.body.appendChild(toast);
  }
  
  toast.innerHTML = `<div class="toast-content">${message}</div>`;
  toast.className = `toast ${type}`;
  if (type === 'error') {
    toast.style.borderLeftColor = '#f56565';
  } else {
    toast.style.borderLeftColor = '#48bb78';
  }
  
  toast.style.transform = 'translateX(0)';
  
  setTimeout(() => {
    toast.style.transform = 'translateX(400px)';
  }, 3000);
}
</script>
{% endblock %}

